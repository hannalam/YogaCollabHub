{% extends 'users/base.html' %} {% load static %} {% block body %}
<div class="flex mt-5 p-5 justify-center">
  <div class="flex user-container mb-2 my-5">
    <h2 class="text-3xl font-norma m-10 text-gray-500">Edit Class</h2>
    <a
      class="bg-blue-700 text-white m-10 px-2 py-2"
      href="{% url 'class_list'%}"
      >Back to Class list</a
    >
  </div>
</div>

<div class="grid mx-60 p-5 grid-cols-1">
  <div class="bg-gray-300 p-5">
        <div class="bg-blue-100 mx-20 my-2 font-bold text-lg p-5 shadow-md">
      <span>{{yoga_class_detail.title}}</span>
    </div>

    <div class="mx-20 my-2 p-5 bg-gray-50 shadow-md">
      <div> <strong>Type: </strong> {{yoga_class_detail.class_type}}</div>
      <div> <strong>Tutor: </strong>{{yoga_class_detail.tutor}}</div>
      <h4> <strong>Date: </strong>{{yoga_class_detail.date}}</h4>
      <h4> <strong>Time: </strong>{{yoga_class_detail.time}}</h4>
      <h4> <strong>Location: </strong>{{yoga_class_detail.location}}</h4>
    </div>
    <h4 class="mx-20 font-bold">Classroom Equipment:</h4>
    <div class="mx-20 my-2 p-5 bg-gray-50 shadow-md">
      <div>{{yoga_class_detail.classroom_equipment}}</div>
    </div>
    <h4 class="mx-20 font-bold">Description:</h4>
    <div class="mx-20 my-2 p-5 bg-gray-50 shadow-md">
      <div>{{yoga_class_detail.description}}</div>
    </div>

    <br><br>
    <div class="bg-blue-100 mx-20 my-2 font-bold text-lg p-5 shadow-md">
      <span>Class Materials</span>
    </div>
    
    <h4 class="mx-20 font-bold">Image:</h4>
    <div class="mx-20 my-2 p-5  shadow-md">
      <img class="h-80 rounded-full"
        src="{{yoga_class_detail.image_material.url}}"
        alt=""/>
    </div>

    <h4 class="mx-20 font-bold">Audio:</h4>
    <div class="mx-20 my-2 p-5  shadow-md">
      <audio controls id="player">
        <source src="{{yoga_class_detail.audio_material.url}}" type="audio/wav">
        Your browser does not support the audio element.
      </audio>
      <div>{{yoga_class_detail.audio_material}}</div>
    </div>

    <h4 class="mx-20 font-bold">Video:</h4>
    <div class="mx-20 my-2 p-5  shadow-md">
      <video width='500' controls>
      <source src='{{yoga_class_detail.video_material.url}}' type='video/mp4'>
      Your browser does not support the video tag.
    </video>
      <div>{{yoga_class_detail.video_material}}</div>
    </div>

  </br>

  <div class="px-3 py-4 mx-20 mb-2">
    <div class="icon-container flex gap-3">
      <a id="{{session.id}}" class="btn-like">
        {% if logged_user in interaction.liked_by_user.all %}
        <img
          class="w-5 h-5"
          src="{% static 'users/images/redlike.png' %}"
          alt="https://www.iconfinder.com/icons/652556/beautiful_design_heart_love_red_romance_valentine_icon"
        />
        {% else %}
        <img
          class="w-5 h-5"
          src="{% static 'users/images/like.png' %}"
          alt="https://www.iconfinder.com/icons/8666647/heart_icon"
        />
        {% endif %}
      </a>
      <a>
        <img
          class="w-5 h-5"
          src="{% static 'users/images/comment.png' %}"
          alt="https://www.iconfinder.com/icons/8664929/comment_chat_message_icon"
        />
      </a>
      <a>
        <img
          class="w-5 h-5"
          src="{% static 'users/images/share.png' %}"
          alt="https://www.iconfinder.com/icons/9026047/share_network_icon"
        />
      </a>
    </div>
    {% if interaction.liked_by_user.count < 1 %} {% elif
    interaction.liked_by_user.count == 1 %} {{
    interaction.liked_by_user.first }} Likes this {% elif
    interaction.liked_by_user.count > 1 %} {{interaction.liked_by_user.first
    }} & {{ interaction.liked_by_user.count }} Likes this {% endif %}
  </div>

  <div>
    <p class="text-gray-700 text-base">
      {% for comment in interaction.session_comment.all %}
      <b>{{comment.posted_by}}</b>:{{comment.body}} 
    </p>
    {% endfor %}
  </div>
  <div class="">
    <form method="post" class="mx-20 mb-2 my-5">
      {% csrf_token %}
      <div class="rounded mr-10 py-2 text-green-700">
        {{ comment_form.body }}
        <button class="bg-green-500 text-white px-5 py-1" type="submit">
        Add
      </button>
      </div>
    </form>
  </div>


<!-- Display Interactions -->
<h3>Interactions</h3>
<ul>
  {% for interaction in interaction %}
  <li>
    <p>User: {{ interaction.user }}</p>
    <p>Date: {{ interaction.date }}</p>
    <!-- Display other interaction details as needed -->
  </li>
  {% endfor %}
</ul>

<!-- Comment Form -->
<h3>Add Comment</h3>
<form method="post">
  {% csrf_token %}
  {{ comment_form.as_p }}
  <input type="hidden" name="session_id" value="{{ yoga_class_detail.id }}">
  <button type="submit">Submit</button>
</form>

</div>
<script type="text/javascript">
  window.CSRF_TOKEN = "{{ csrf_token }}";
  $(document).on("click", ".btn-like", function () {
    console.log("This is working");
    var session_id = this.id;
    $.ajax({
      method: "POST",
      url: "/session/like",
      data: { session_id: session_id, csrfmiddlewaretoken: window.CSRF_TOKEN },
    });
    window.location.href = "http://127.0.0.1:8000/session/dashboard";
  });
</script>
  </div>
</div>

{% endblock %}
